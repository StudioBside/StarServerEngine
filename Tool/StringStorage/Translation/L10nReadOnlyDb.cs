namespace StringStorage.Translation;

using System;
using Cs.Core.Util;
using StringStorage.Detail;

public sealed class L10nReadOnlyDb(string path) : IDisposable
{
    public const string ValueStringDbName = "ValueString.db";
    public const string KeyStringDbName = "KeyString.db";

    private readonly LevelDbReadOnly dbController = new(path);

    public void Dispose()
    {
        this.dbController.Dispose();
    }

    public SingleTextSet Get(string key)
    {
        if (this.dbController.TryGet(key, SingleTextSet.TryCreate, out var textSet) == false)
        {
            textSet = new SingleTextSet
            {
                CreatedAt = ServiceTime.Recent,
            };
        }

        return textSet;
    }
}
